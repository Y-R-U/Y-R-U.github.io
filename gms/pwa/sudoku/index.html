<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="theme-color" content="#4a90e2">
<link rel="manifest" href="./manifest.json">
<title>Sudoku Game</title>
<style>
*{margin:0;padding:0;box-sizing:border-box;}
body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Oxygen,Ubuntu,Cantarell,sans-serif;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);min-height:100vh;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:10px;color:#333;}
.container{max-width:600px;width:100%;background:white;border-radius:16px;box-shadow:0 10px 40px rgba(0,0,0,0.2);padding:20px;display:flex;flex-direction:column;gap:15px;}
h1{text-align:center;color:#4a90e2;font-size:clamp(1.5rem,5vw,2.5rem);text-shadow:2px 2px 4px rgba(0,0,0,0.1);}
.stats{display:flex;justify-content:space-around;gap:10px;flex-wrap:wrap;}
.stat{flex:1;min-width:80px;background:#f0f4f8;padding:10px;border-radius:8px;text-align:center;}
.stat-label{font-size:0.75rem;color:#666;text-transform:uppercase;letter-spacing:0.5px;}
.stat-value{font-size:1.5rem;font-weight:bold;color:#4a90e2;margin-top:5px;}
.difficulty{display:flex;gap:10px;justify-content:center;flex-wrap:wrap;}
.diff-btn{flex:1;min-width:80px;padding:12px 20px;border:2px solid #4a90e2;background:white;color:#4a90e2;border-radius:8px;cursor:pointer;font-size:1rem;font-weight:600;transition:all 0.3s;text-transform:uppercase;letter-spacing:0.5px;}
.diff-btn:hover{background:#4a90e2;color:white;transform:translateY(-2px);box-shadow:0 4px 12px rgba(74,144,226,0.3);}
.diff-btn.active{background:#4a90e2;color:white;box-shadow:0 4px 12px rgba(74,144,226,0.3);}
.message{text-align:center;padding:12px;border-radius:8px;font-weight:600;min-height:48px;display:flex;align-items:center;justify-content:center;gap:10px;flex-wrap:wrap;}
.message.error{background:#ffe0e0;color:#d32f2f;border:2px solid #d32f2f;}
.message.success{background:#e0f7e9;color:#2e7d32;border:2px solid #2e7d32;}
.message.hidden{display:none;}
.restart-link{color:inherit;text-decoration:underline;cursor:pointer;font-weight:700;}
.game-container{aspect-ratio:1;width:100%;max-width:500px;margin:0 auto;position:relative;}
.grid{display:grid;grid-template-columns:repeat(9,1fr);grid-template-rows:repeat(9,1fr);gap:0;border:3px solid #333;background:#333;width:100%;height:100%;border-radius:4px;overflow:hidden;}
.grid.error-border{border-color:#d32f2f;animation:shake 0.5s;}
@keyframes shake{0%,100%{transform:translateX(0);}25%{transform:translateX(-5px);}75%{transform:translateX(5px);}}
.cell{background:white;border:1px solid #ccc;display:flex;align-items:center;justify-content:center;font-size:clamp(1rem,3vw,1.5rem);font-weight:600;cursor:pointer;transition:all 0.2s;user-select:none;-webkit-user-select:none;-webkit-tap-highlight-color:transparent;position:relative;}
.cell:nth-child(3n):not(:nth-child(9n)){border-right:2px solid #333;}
.cell:nth-child(n+19):nth-child(-n+27),.cell:nth-child(n+46):nth-child(-n+54){border-bottom:2px solid #333;}
.cell.given{background:#f0f4f8;color:#333;font-weight:700;}
.cell.filled{color:#4a90e2;}
.cell.selected{background:#bbdefb;box-shadow:inset 0 0 0 2px #4a90e2;}
.cell.conflict{background:#ffcccc;color:#d32f2f;}
.cell.same-number-highlight{background:#fff59d;font-weight:700;}
.cell:hover:not(.given){background:#e3f2fd;}
.popup{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.7);display:none;align-items:center;justify-content:center;z-index:1000;padding:20px;}
.popup.active{display:flex;}
.popup-content{background:white;border-radius:12px;padding:20px;max-width:400px;width:100%;box-shadow:0 10px 40px rgba(0,0,0,0.3);}
.number-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:10px;margin-bottom:15px;}
.number-btn{padding:20px;background:#f0f4f8;border:2px solid #4a90e2;border-radius:8px;font-size:1.5rem;font-weight:bold;cursor:pointer;transition:all 0.2s;color:#4a90e2;}
.number-btn:hover{background:#4a90e2;color:white;transform:scale(1.05);}
.popup-actions{display:flex;gap:10px;}
.popup-btn{flex:1;padding:12px;border:2px solid #4a90e2;background:white;color:#4a90e2;border-radius:8px;cursor:pointer;font-weight:600;transition:all 0.2s;}
.popup-btn:hover{background:#4a90e2;color:white;}
.controls{display:flex;gap:10px;flex-wrap:wrap;justify-content:center;}
.control-btn{padding:10px 20px;border:2px solid #666;background:white;color:#666;border-radius:8px;cursor:pointer;font-weight:600;transition:all 0.2s;}
.control-btn:hover{background:#666;color:white;transform:translateY(-2px);}
.install-btn{background:#4caf50;color:white;border:2px solid #4caf50;padding:12px 24px;border-radius:8px;cursor:pointer;font-weight:600;transition:all 0.3s;display:block;}
.install-btn:hover{background:#45a049;transform:translateY(-2px);box-shadow:0 4px 12px rgba(76,175,80,0.3);}
</style>
</head>
<body>
<div class="container">
<h1>üß© Sudoku</h1>
<div class="stats">
<div class="stat"><div class="stat-label">Easy</div><div class="stat-value" id="easyWins">0</div></div>
<div class="stat"><div class="stat-label">Medium</div><div class="stat-value" id="mediumWins">0</div></div>
<div class="stat"><div class="stat-label">Hard</div><div class="stat-value" id="hardWins">0</div></div>
</div>
<div class="difficulty">
<button class="diff-btn active" data-level="easy">Easy</button>
<button class="diff-btn" data-level="medium">Medium</button>
<button class="diff-btn" data-level="hard">Hard</button>
</div>
<div class="message hidden" id="message"></div>
<div class="game-container">
<div class="grid" id="grid"></div>
</div>
<div class="controls">
<button class="control-btn" id="newGame">New Game</button>
<button class="control-btn" id="undoBtn">Undo</button>
<button class="install-btn" id="installBtn">Install App</button>
</div>
</div>
<div class="popup" id="popup">
<div class="popup-content">
<div class="number-grid" id="numberGrid"></div>
<div class="popup-actions">
<button class="popup-btn" id="clearCell">Clear</button>
<button class="popup-btn" id="closePopup">Cancel</button>
</div>
</div>
</div>
<script>
class SudokuGame {
constructor() {
this.grid = Array(9).fill().map(() => Array(9).fill(0));
this.solution = Array(9).fill().map(() => Array(9).fill(0));
this.given = Array(9).fill().map(() => Array(9).fill(false));
this.level = 'easy';
this.selected = null;
this.lastNumber = 0;
this.history = [];
this.stats = JSON.parse(localStorage.getItem('sudokuStats')) || {easy: 0, medium: 0, hard: 0};
this.deferredPrompt = null;
this.init();
}
init() {
this.updateStats();
this.createGrid();
this.newGame();
document.querySelectorAll('.diff-btn').forEach(btn => {
btn.addEventListener('click', () => this.changeDifficulty(btn.dataset.level));
});
document.getElementById('newGame').addEventListener('click', () => this.confirmNewGame());
document.getElementById('undoBtn').addEventListener('click', () => this.undo());
document.getElementById('closePopup').addEventListener('click', () => this.closePopup());
document.getElementById('clearCell').addEventListener('click', () => this.clearSelected());
document.getElementById('popup').addEventListener('click', (e) => {
if (e.target.id === 'popup') this.closePopup();
});
window.addEventListener('beforeinstallprompt', (e) => {
e.preventDefault();
this.deferredPrompt = e;
});
document.getElementById('installBtn').addEventListener('click', () => this.installApp());
if ('serviceWorker' in navigator) {navigator.serviceWorker.register('/gms/pwa/sudoku/sw.js').then(reg => console.log('SW registered', reg)).catch(err => console.log('SW failed', err));}
}
createGrid() {
const gridEl = document.getElementById('grid');
gridEl.innerHTML = '';
for (let i = 0; i < 81; i++) {
const cell = document.createElement('div');
cell.className = 'cell';
cell.dataset.index = i;
cell.addEventListener('click', () => this.selectCell(i));
cell.addEventListener('contextmenu', (e) => {
e.preventDefault();
this.selectCell(i);
this.showPopup();
});
let touchTimer;
cell.addEventListener('touchstart', (e) => {
touchTimer = setTimeout(() => {
e.preventDefault();
this.selectCell(i);
this.showPopup();
}, 500);
});
cell.addEventListener('touchend', () => clearTimeout(touchTimer));
cell.addEventListener('touchmove', () => clearTimeout(touchTimer));
gridEl.appendChild(cell);
}
}
generateSolution() {
this.solution = Array(9).fill().map(() => Array(9).fill(0));
this.fillGrid(this.solution);
return true;
}
fillGrid(grid, row = 0, col = 0) {
if (row === 9) return true;
if (col === 9) return this.fillGrid(grid, row + 1, 0);
const nums = [1, 2, 3, 4, 5, 6, 7, 8, 9].sort(() => Math.random() - 0.5);
for (let num of nums) {
if (this.isValid(grid, row, col, num)) {
grid[row][col] = num;
if (this.fillGrid(grid, row, col + 1)) return true;
grid[row][col] = 0;
}
}
return false;
}
isValid(grid, row, col, num) {
for (let i = 0; i < 9; i++) {
if (grid[row][i] === num || grid[i][col] === num) return false;
}
const boxRow = Math.floor(row / 3) * 3;
const boxCol = Math.floor(col / 3) * 3;
for (let i = 0; i < 3; i++) {
for (let j = 0; j < 3; j++) {
if (grid[boxRow + i][boxCol + j] === num) return false;
}
}
return true;
}
canPlaceNumber(row, col, num) {
const boxRow = Math.floor(row / 3) * 3;
const boxCol = Math.floor(col / 3) * 3;
for (let i = 0; i < 3; i++) {
for (let j = 0; j < 3; j++) {
if (this.grid[boxRow + i][boxCol + j] === num) return false;
}
}
return true;
}
newGame() {
this.generateSolution();
this.grid = this.solution.map(row => [...row]);
this.given = Array(9).fill().map(() => Array(9).fill(false));
this.history = [];
this.selected = null;
this.lastNumber = 0;
const cellsToRemove = {easy: 35, medium: 45, hard: 55}[this.level];
let removed = 0;
while (removed < cellsToRemove) {
const row = Math.floor(Math.random() * 9);
const col = Math.floor(Math.random() * 9);
if (this.grid[row][col] !== 0) {
this.grid[row][col] = 0;
removed++;
}
}
for (let i = 0; i < 9; i++) {
for (let j = 0; j < 9; j++) {
if (this.grid[i][j] !== 0) this.given[i][j] = true;
}
}
this.render();
this.hideMessage();
}
changeDifficulty(level) {
this.level = level;
document.querySelectorAll('.diff-btn').forEach(btn => {
btn.classList.toggle('active', btn.dataset.level === level);
});
this.newGame();
}
selectCell(index) {
const row = Math.floor(index / 9);
const col = index % 9;
if (this.given[row][col]) return;
this.selected = index;
const currentValue = this.grid[row][col];
if (currentValue > 0) {
this.showPopup();
this.render();
return;
}
if (this.lastNumber > 0 && this.canPlaceNumber(row, col, this.lastNumber)) {
this.placeNumber(this.lastNumber);
} else {
this.showPopup();
}
this.render();
}
showPopup() {
if (this.selected === null) return;
const popup = document.getElementById('popup');
const numberGrid = document.getElementById('numberGrid');
numberGrid.innerHTML = '';
for (let i = 1; i <= 9; i++) {
const btn = document.createElement('button');
btn.className = 'number-btn';
btn.textContent = i;
btn.addEventListener('click', () => this.placeNumber(i));
numberGrid.appendChild(btn);
}
popup.classList.add('active');
}
closePopup() {
document.getElementById('popup').classList.remove('active');
}
placeNumber(num) {
if (this.selected === null) return;
const row = Math.floor(this.selected / 9);
const col = this.selected % 9;
if (this.given[row][col]) return;
this.history.push({index: this.selected, value: this.grid[row][col]});
this.grid[row][col] = num;
this.lastNumber = num;
this.closePopup();
this.render();
if (this.isComplete()) {
this.checkSolution();
}
}
clearSelected() {
if (this.selected === null) return;
const row = Math.floor(this.selected / 9);
const col = this.selected % 9;
if (this.given[row][col]) return;
this.history.push({index: this.selected, value: this.grid[row][col]});
this.grid[row][col] = 0;
this.closePopup();
this.render();
}
undo() {
if (this.history.length === 0) return;
const last = this.history.pop();
const row = Math.floor(last.index / 9);
const col = last.index % 9;
this.grid[row][col] = last.value;
this.selected = last.index;
this.render();
}
isComplete() {
for (let i = 0; i < 9; i++) {
for (let j = 0; j < 9; j++) {
if (this.grid[i][j] === 0) return false;
}
}
return true;
}
checkSolution() {
let correct = true;
for (let i = 0; i < 9; i++) {
for (let j = 0; j < 9; j++) {
if (this.grid[i][j] !== this.solution[i][j]) {
correct = false;
break;
}
}
}
if (correct) {
this.stats[this.level]++;
localStorage.setItem('sudokuStats', JSON.stringify(this.stats));
this.updateStats();
this.showMessage('üéâ Congratulations! You solved it!', 'success');
setTimeout(() => this.newGame(), 3000);
} else {
this.showMessage('‚ùå Incorrect solution. <span class="restart-link" onclick="game.confirmRestart()">Restart?</span>', 'error');
document.getElementById('grid').classList.add('error-border');
setTimeout(() => {
this.hideMessage();
document.getElementById('grid').classList.remove('error-border');
}, 5000);
}
}
confirmRestart() {
if (confirm('Are you sure you want to restart this game?')) {
this.newGame();
}
}
confirmNewGame() {
if (confirm('Start a new game? Current progress will be lost.')) {
this.newGame();
}
}
showMessage(text, type) {
const msg = document.getElementById('message');
msg.innerHTML = text;
msg.className = `message ${type}`;
msg.classList.remove('hidden');
}
hideMessage() {
document.getElementById('message').classList.add('hidden');
}
updateStats() {
document.getElementById('easyWins').textContent = this.stats.easy;
document.getElementById('mediumWins').textContent = this.stats.medium;
document.getElementById('hardWins').textContent = this.stats.hard;
}
installApp() {
if (this.deferredPrompt) {
this.deferredPrompt.prompt();
this.deferredPrompt.userChoice.then(choice => {
if (choice.outcome === 'accepted') {
this.showMessage('‚úÖ App installed successfully!', 'success');
setTimeout(() => this.hideMessage(), 3000);
}
this.deferredPrompt = null;
});
} else {
this.showMessage('‚ÑπÔ∏è To install: On iOS use Share > Add to Home Screen. On Android use browser menu > Install App.', 'success');
setTimeout(() => this.hideMessage(), 5000);
}
}
render() {
const cells = document.querySelectorAll('.cell');
const selectedRow = this.selected !== null ? Math.floor(this.selected / 9) : -1;
const selectedCol = this.selected !== null ? this.selected % 9 : -1;
const selectedNum = this.selected !== null ? this.grid[selectedRow][selectedCol] : 0;
cells.forEach((cell, index) => {
const row = Math.floor(index / 9);
const col = index % 9;
const value = this.grid[row][col];
cell.textContent = value || '';
cell.className = 'cell';
if (this.given[row][col]) cell.classList.add('given');
else if (value) cell.classList.add('filled');
if (index === this.selected) cell.classList.add('selected');
if (selectedNum > 0 && value === selectedNum && value !== 0) cell.classList.add('same-number-highlight');
if (value > 0 && !this.given[row][col]) {
let conflict = false;
for (let i = 0; i < 9; i++) {
if (i !== col && this.grid[row][i] === value) conflict = true;
if (i !== row && this.grid[i][col] === value) conflict = true;
}
const boxRow = Math.floor(row / 3) * 3;
const boxCol = Math.floor(col / 3) * 3;
for (let i = 0; i < 3; i++) {
for (let j = 0; j < 3; j++) {
const r = boxRow + i;
const c = boxCol + j;
if ((r !== row || c !== col) && this.grid[r][c] === value) conflict = true;
}
}
if (conflict) cell.classList.add('conflict');
}
});
}
}
const game = new SudokuGame();
</script>
</body>
</html>
